#  CloudKassir модуль для CS-Cart

Модуль позволяет интегрировать онлайн-кассу [CloudKassir](https://cloudkassir.ru/) в интернет-магазин на платформе CSCart.

### Совместимость:
* CSCart v.4.7.x

_Если вы используете платежный модуль CloudPayments совместно с модулем CloudKassir, то убедитесь, что в платежном модуле отключена отправка чеков через онлайн-кассу, во избежание дублирования кассовых чеков._

### Возможности:    
• Поддержка онлайн-касс (ФЗ-54);  
• Автоматическая отправка чеков прихода по email и SMS;  
• Отправка чеков возврата по email и SMS;  

## Установка модуля

1. Разархивируйте модуль и скопируйте содержимое папки upload в корень сайта
2. В разделе "Модули" -> "Управление модулями" перейдите на вкладку "Посмотреть все доступные модули"
3. Найдите в списке модуль "CloudKassir: Сервис онлайн кассы" и установите его 

## Настройка модуля
Для настройки модуля в разделе "Модули" -> "Управление модулями" найдите модуль "CloudKassir: Сервис онлайн кассы" и нажмите на его название.

Укажите следующие настройки:
* **Идентификатор сайта** — Public id сайта из личного кабинета CloudPayments
* **Секретный ключ** — API Secret из личного кабинета CloudPayments
* **ИНН** — ИНН организации, на которую зарегистрирована онлайн-касса
* **Система налогообложения** — Тип системы налогообложения.
    Возможные значения перечислены в [документации CloudPayments](https://cloudpayments.ru/wiki/integration/instrumenti/apikassa#var)   
* **Статусы оплаченных заказов** — Когда заказ получает один из этих статусов, пробивается чек продажи. 
* **Статусы возвращенных заказов** — Когда заказ получает один из этих статусов, пробивается чек полного возврата.

Затем сохранить введенные параметры.

![Настройки модуля CloudKassir](doc/img/cscart_settings.png)

## Настройка способов оплаты
В CS-Cart можно выбрать, при каких способах оплаты CloudKassir должен пробивать чек. Для этого:
1. В панели администратора откройте страницу "Администрирование" -> "Способы оплаты"
2. Найдите в списке нужный способ оплаты и нажмите на его название, чтобы открыть страницу редактирования.
3. Поставьте галочку "Отправлять данные для чеков в CloudKassir".
4. Сохраните настройки
5. Повторите эти действия для всех способов оплаты, для которых нужно использовать онлайн-кассу.

![Настройка пробивания чека для оплаты](doc/img/cscart_payment.png)
